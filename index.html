<!DOCTYPE html>
<html>
  <head>
    <title>Sinopia Linked Data - Graph Explorer</title>
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <link href="static/css/main.css" rel="stylesheet" />
    <link href="static/css/header.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    <style>
      strong {
        font-weight: 800;
      }
    </style>
    <py-env>
      - pandas
      - markdown
      - nltk
      - scikit-learn
      - Jinja2
      - './static/wheels/rdflib-6.1.1-py3-none-any.whl'
      - './static/wheels/pyshacl-0.19.0-py3-none-any.whl'
      - paths:
        - ./helpers.py
        - ./widgets/load_rdf.py
        - ./widgets/sinopia_api.py
    </py-env>
    <py-script>
      import sys
      # Hack to load rdflib
      setattr(sys.stderr, 'isatty', lambda : True)

      from pyodide import create_proxy
      import helpers

      import rdflib


      BIBFRAME = rdflib.Namespace("http://id.loc.gov/ontologies/bibframe/")
      SINOPIA = rdflib.Namespace("http://sinopia.io/vocabulary/")

      from sinopia_api import sinopia_api as sinopia_env_widget
      from load_rdf import bibframe as bibframe_widget
      from load_rdf import bibframe_sparql as bf_sparql_widget

      for element_id in ['intro',
                         'pandas',
                         'retrieve-rdf',
                         'bf-work-instance-item-rdf']:
          helpers.render_markdown(Element(element_id))

 
      sinopia_env_widget(Element("sinopia-api-group-widget"))
      entities = [ 
        "https://api.stage.sinopia.io/resource/6861fc10-0213-4dfc-b1a0-7df975d235dd",
        "https://api.stage.sinopia.io/resource/986d673d-f006-44ab-8bf7-b92b279fddfa",
        "https://api.stage.sinopia.io/resource/16061ffa-147a-4b67-9a12-0990964f32d4"
      ]
      bibframe_widget("bibframe-widget", entities)
      bf_sparql_widget("bf-sparql-query")
     </py-script>
  </head>
  <body>
    <div class="editor-navbar">
       <h3>Linked-Data for Production</h3>
       <h1>Graph Explorer with Sinopia Linked Data</h1>
       <h4>Version 0.0.1</h4>
    </div>
    <div class="float-end sticky-top">
      <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#graph-repl-modal">
        <img width="64" alt="Python-logo-notext" src="./static/img/python-repl.svg">         
      </button>
    </div>
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" 
                id="home-tab" 
                data-bs-toggle="tab" 
                data-bs-target="#load" 
                type="button" 
                role="tab" 
                aria-controls="home" 
                aria-selected="true">Load RDF</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" 
                id="bibframe-tab" 
                data-bs-toggle="tab" 
                data-bs-target="#bibframe" 
                type="button" 
                role="tab" 
                aria-controls="profile" 
                aria-selected="false">BIBFRAME</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">SPARQL</button>
      </li>
    </ul>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
         <h2>Load Environment &amp; Groups</h2>
      </div>
      <div class="tab-pane fade" id="bibframe" role="tabpanel" aria-labelledby="profile-tab">
         <h2>BIBFRAME</h2>
         <div class="container">
           <div id="bf-work-instance-item-rdf">
## PCC BIBFRAME Work-Instance-Item Graph
We can use [Sinopia API](https://github.com/ld4p/sinopia_api) to construct a small 
RDF graph made up of a [BIBFRAME](https://bibframe.org/) Work, Instance, and Item 
and then create a knowledge graph for analysis and visualization of the entities 
along with their properties.
           </div>
          <div class="row">
           <div class="col">
              <div id="bibframe-widget"></div>
           </div>
           <div class="col">
              <div id="summarize-work-instance-item"></div>
           </div>
           </div>
          </div>
         </div>
       <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
        <h2>SPARQL Queries</h2>
        <div class="container">
          <div class="row">
            <div class="col">
              <div id="bf-sparql-query"></div>
            </div>
            <div class="col">
              <div id="bf-sparql-results"></div>
            </div>
          </div>
        </div>
       </div>
    </div>
 
    <div class="modal fade" id="graph-repl-modal" tabindex="-1" aria-labelledby="graph-repl-modal-title" style="display: none;" aria-hidden="true">
      <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="graph-repl-modal-title">Graph Explorer - Python REPL</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="sticky-top py-3 bg-light">
              <div id="err-div" class="bg-red text-blue text-center border-t-4"></div>
              <py-box widths="2/3;1/3">
                <py-repl id="graph-repl" auto-generate="true" std-out="output" std-err="err-div">print("Hello")</py-repl>
                <div id="output" class="p-4"></div>
              </py-box>
            </div>
          </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
